 
 -------------- celery@crawler-node v5.5.1 (immunity)
--- ***** ----- 
-- ******* ---- Linux-6.1.0-31-cloud-amd64-x86_64-with-glibc2.36 2025-04-21 20:39:41
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         tasks:0x7fcb54459c50
- ** ---------- .> transport:   redis://10.128.0.2:6379/0
- ** ---------- .> results:     redis://10.128.0.2:6379/1
- *** --- * --- .> concurrency: 2 (prefork)
-- ******* ---- .> task events: OFF (enable -E to monitor tasks in this worker)
--- ***** ----- 
 -------------- [queues]
                .> crawl_tasks      exchange=crawl(direct) key=crawl.url
                

[tasks]
  . tasks.crawl_url

[2025-04-21 20:39:41,547: INFO/MainProcess] Connected to redis://10.128.0.2:6379/0
[2025-04-21 20:39:41,559: INFO/MainProcess] mingle: searching for neighbors
[2025-04-21 20:39:42,573: INFO/MainProcess] mingle: all alone
[2025-04-21 20:39:42,591: INFO/MainProcess] celery@crawler-node ready.
[2025-04-21 20:42:54,420: INFO/MainProcess] Task tasks.crawl_url[700d98a4-f26f-4338-8649-344d28ed1c98] received
[2025-04-21 20:42:54,426: WARNING/ForkPoolWorker-1] Crawling: https://www.amazon.eg
[2025-04-21 20:42:55,324: WARNING/ForkPoolWorker-1] /home/omaralaa927/myenv/lib/python3.11/site-packages/pymongo/synchronous/mongo_client.py:2565: UserWarning: MongoClient opened before fork. May not be entirely fork-safe, proceed with caution. See PyMongo's documentation for details: https://dochub.mongodb.org/core/pymongo-fork-deadlock
  return self._read() if self._is_read else self._write()

[2025-04-21 20:42:56,360: INFO/MainProcess] Task tasks.crawl_url[1149b4e6-6497-4f4e-b2b1-f9c361a1391c] received
[2025-04-21 20:42:56,364: WARNING/ForkPoolWorker-2] Crawling: https://en.wikipedia.org/wiki/Web_crawler
[2025-04-21 20:42:56,698: WARNING/ForkPoolWorker-2] /home/omaralaa927/myenv/lib/python3.11/site-packages/pymongo/synchronous/mongo_client.py:2565: UserWarning: MongoClient opened before fork. May not be entirely fork-safe, proceed with caution. See PyMongo's documentation for details: https://dochub.mongodb.org/core/pymongo-fork-deadlock
  return self._read() if self._is_read else self._write()

[2025-04-21 20:42:58,041: INFO/ForkPoolWorker-1] PUT http://10.128.0.2:9200/web_pages/_doc/https%3A%2F%2Fwww.amazon.eg [status:N/A duration:0.001s]
[2025-04-21 20:42:58,042: WARNING/ForkPoolWorker-1] Node <Urllib3HttpNode(http://10.128.0.2:9200)> has failed for 1 times in a row, putting on 1 second timeout
[2025-04-21 20:42:58,042: WARNING/ForkPoolWorker-1] Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
               ^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
  File "/usr/lib/python3.11/http/client.py", line 975, in send
    self.connect()
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fcb50d368d0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fcb50d368d0>: Failed to establish a new connection: [Errno 111] Connection refused)
[2025-04-21 20:42:58,068: INFO/ForkPoolWorker-1] PUT http://10.128.0.2:9200/web_pages/_doc/https%3A%2F%2Fwww.amazon.eg [status:N/A duration:0.002s]
[2025-04-21 20:42:58,068: WARNING/ForkPoolWorker-1] Node <Urllib3HttpNode(http://10.128.0.2:9200)> has failed for 2 times in a row, putting on 2 second timeout
[2025-04-21 20:42:58,068: WARNING/ForkPoolWorker-1] Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
               ^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
  File "/usr/lib/python3.11/http/client.py", line 975, in send
    self.connect()
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fcb50db1e50>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fcb50db1e50>: Failed to establish a new connection: [Errno 111] Connection refused)
[2025-04-21 20:42:58,072: INFO/ForkPoolWorker-1] PUT http://10.128.0.2:9200/web_pages/_doc/https%3A%2F%2Fwww.amazon.eg [status:N/A duration:0.001s]
[2025-04-21 20:42:58,072: WARNING/ForkPoolWorker-1] Node <Urllib3HttpNode(http://10.128.0.2:9200)> has failed for 3 times in a row, putting on 4 second timeout
[2025-04-21 20:42:58,072: WARNING/ForkPoolWorker-1] Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
               ^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
  File "/usr/lib/python3.11/http/client.py", line 975, in send
    self.connect()
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fcb50db2b90>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fcb50db2b90>: Failed to establish a new connection: [Errno 111] Connection refused)
[2025-04-21 20:42:58,076: INFO/ForkPoolWorker-1] PUT http://10.128.0.2:9200/web_pages/_doc/https%3A%2F%2Fwww.amazon.eg [status:N/A duration:0.002s]
[2025-04-21 20:42:58,076: WARNING/ForkPoolWorker-1] Node <Urllib3HttpNode(http://10.128.0.2:9200)> has failed for 4 times in a row, putting on 8 second timeout
[2025-04-21 20:42:58,280: WARNING/ForkPoolWorker-1] [Error] https://www.amazon.eg -> Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fcb50d368d0>: Failed to establish a new connection: [Errno 111] Connection refused))
[2025-04-21 20:42:58,287: INFO/ForkPoolWorker-1] Task tasks.crawl_url[700d98a4-f26f-4338-8649-344d28ed1c98] succeeded in 3.8621929770000634s: None
[2025-04-21 20:42:59,511: INFO/ForkPoolWorker-2] PUT http://10.128.0.2:9200/web_pages/_doc/https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FWeb_crawler [status:N/A duration:0.001s]
[2025-04-21 20:42:59,511: WARNING/ForkPoolWorker-2] Node <Urllib3HttpNode(http://10.128.0.2:9200)> has failed for 1 times in a row, putting on 1 second timeout
[2025-04-21 20:42:59,511: WARNING/ForkPoolWorker-2] Retrying request after failure (attempt 0 of 3)
Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
               ^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
  File "/usr/lib/python3.11/http/client.py", line 975, in send
    self.connect()
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fcb50a72050>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fcb50a72050>: Failed to establish a new connection: [Errno 111] Connection refused)
[2025-04-21 20:42:59,517: INFO/ForkPoolWorker-2] PUT http://10.128.0.2:9200/web_pages/_doc/https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FWeb_crawler [status:N/A duration:0.002s]
[2025-04-21 20:42:59,518: WARNING/ForkPoolWorker-2] Node <Urllib3HttpNode(http://10.128.0.2:9200)> has failed for 2 times in a row, putting on 2 second timeout
[2025-04-21 20:42:59,518: WARNING/ForkPoolWorker-2] Retrying request after failure (attempt 1 of 3)
Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
               ^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
  File "/usr/lib/python3.11/http/client.py", line 975, in send
    self.connect()
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fcb50af43d0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fcb50af43d0>: Failed to establish a new connection: [Errno 111] Connection refused)
[2025-04-21 20:42:59,521: INFO/ForkPoolWorker-2] PUT http://10.128.0.2:9200/web_pages/_doc/https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FWeb_crawler [status:N/A duration:0.001s]
[2025-04-21 20:42:59,521: WARNING/ForkPoolWorker-2] Node <Urllib3HttpNode(http://10.128.0.2:9200)> has failed for 3 times in a row, putting on 4 second timeout
[2025-04-21 20:42:59,521: WARNING/ForkPoolWorker-2] Retrying request after failure (attempt 2 of 3)
Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_node/_http_urllib3.py", line 167, in perform_request
    response = self.pool.urlopen(
               ^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/util/util.py", line 39, in reraise
    raise value
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
  File "/usr/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
  File "/usr/lib/python3.11/http/client.py", line 975, in send
    self.connect()
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7fcb50af4dd0>: Failed to establish a new connection: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_transport.py", line 342, in perform_request
    resp = node.perform_request(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/omaralaa927/myenv/lib/python3.11/site-packages/elastic_transport/_node/_http_urllib3.py", line 202, in perform_request
    raise err from e
elastic_transport.ConnectionError: Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fcb50af4dd0>: Failed to establish a new connection: [Errno 111] Connection refused)
[2025-04-21 20:42:59,524: INFO/ForkPoolWorker-2] PUT http://10.128.0.2:9200/web_pages/_doc/https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FWeb_crawler [status:N/A duration:0.001s]
[2025-04-21 20:42:59,524: WARNING/ForkPoolWorker-2] Node <Urllib3HttpNode(http://10.128.0.2:9200)> has failed for 4 times in a row, putting on 8 second timeout
[2025-04-21 20:42:59,731: WARNING/ForkPoolWorker-2] [Error] https://en.wikipedia.org/wiki/Web_crawler -> Connection error caused by: ConnectionError(Connection error caused by: NewConnectionError(<urllib3.connection.HTTPConnection object at 0x7fcb50a72050>: Failed to establish a new connection: [Errno 111] Connection refused))
[2025-04-21 20:42:59,737: INFO/ForkPoolWorker-2] Task tasks.crawl_url[1149b4e6-6497-4f4e-b2b1-f9c361a1391c] succeeded in 3.3743347880000556s: None
